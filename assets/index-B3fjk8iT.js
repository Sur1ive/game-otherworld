var Oe=Object.defineProperty;var Pe=(t,e,n)=>e in t?Oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var O=(t,e,n)=>Pe(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();var Kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Vt={};/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var te;function Ee(){if(te)return Vt;te=1;var t;return function(e){(function(n){var r=typeof globalThis=="object"?globalThis:typeof Kt=="object"?Kt:typeof self=="object"?self:typeof this=="object"?this:w(),i=c(e);typeof r.Reflect<"u"&&(i=c(r.Reflect,i)),n(i,r),typeof r.Reflect>"u"&&(r.Reflect=e);function c(P,S){return function(C,g){Object.defineProperty(P,C,{configurable:!0,writable:!0,value:g}),S&&S(C,g)}}function d(){try{return Function("return this;")()}catch{}}function y(){try{return(0,eval)("(function() { return this; })()")}catch{}}function w(){return d()||y()}})(function(n,r){var i=Object.prototype.hasOwnProperty,c=typeof Symbol=="function",d=c&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",y=c&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",w=typeof Object.create=="function",P={__proto__:[]}instanceof Array,S=!w&&!P,C={create:w?function(){return kt(Object.create(null))}:P?function(){return kt({__proto__:null})}:function(){return kt({})},has:S?function(o,a){return i.call(o,a)}:function(o,a){return a in o},get:S?function(o,a){return i.call(o,a)?o[a]:void 0}:function(o,a){return o[a]}},g=Object.getPrototypeOf(Function),Q=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Me(),tt=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:_e(),st=typeof WeakMap=="function"?WeakMap:ke(),L=c?Symbol.for("@reflect-metadata:registry"):void 0,H=xe(),F=Se(H);function j(o,a,s,f){if(x(s)){if(!Ut(o))throw new TypeError;if(!Wt(a))throw new TypeError;return mt(o,a)}else{if(!Ut(o))throw new TypeError;if(!z(a))throw new TypeError;if(!z(f)&&!x(f)&&!ot(f))throw new TypeError;return ot(f)&&(f=void 0),s=V(s),yt(o,a,s,f)}}n("decorate",j);function J(o,a){function s(f,b){if(!z(f))throw new TypeError;if(!x(b)&&!we(b))throw new TypeError;jt(o,a,f,b)}return s}n("metadata",J);function E(o,a,s,f){if(!z(s))throw new TypeError;return x(f)||(f=V(f)),jt(o,a,s,f)}n("defineMetadata",E);function R(o,a,s){if(!z(a))throw new TypeError;return x(s)||(s=V(s)),rt(o,a,s)}n("hasMetadata",R);function K(o,a,s){if(!z(a))throw new TypeError;return x(s)||(s=V(s)),T(o,a,s)}n("hasOwnMetadata",K);function $(o,a,s){if(!z(a))throw new TypeError;return x(s)||(s=V(s)),X(o,a,s)}n("getMetadata",$);function At(o,a,s){if(!z(a))throw new TypeError;return x(s)||(s=V(s)),Gt(o,a,s)}n("getOwnMetadata",At);function lt(o,a){if(!z(o))throw new TypeError;return x(a)||(a=V(a)),Rt(o,a)}n("getMetadataKeys",lt);function ht(o,a){if(!z(o))throw new TypeError;return x(a)||(a=V(a)),Bt(o,a)}n("getOwnMetadataKeys",ht);function gt(o,a,s){if(!z(a))throw new TypeError;if(x(s)||(s=V(s)),!z(a))throw new TypeError;x(s)||(s=V(s));var f=ct(a,s,!1);return x(f)?!1:f.OrdinaryDeleteMetadata(o,a,s)}n("deleteMetadata",gt);function mt(o,a){for(var s=o.length-1;s>=0;--s){var f=o[s],b=f(a);if(!x(b)&&!ot(b)){if(!Wt(b))throw new TypeError;a=b}}return a}function yt(o,a,s,f){for(var b=o.length-1;b>=0;--b){var I=o[b],G=I(a,s,f);if(!x(G)&&!ot(G)){if(!z(G))throw new TypeError;f=G}}return f}function rt(o,a,s){var f=T(o,a,s);if(f)return!0;var b=_t(a);return ot(b)?!1:rt(o,b,s)}function T(o,a,s){var f=ct(a,s,!1);return x(f)?!1:Ft(f.OrdinaryHasOwnMetadata(o,a,s))}function X(o,a,s){var f=T(o,a,s);if(f)return Gt(o,a,s);var b=_t(a);if(!ot(b))return X(o,b,s)}function Gt(o,a,s){var f=ct(a,s,!1);if(!x(f))return f.OrdinaryGetOwnMetadata(o,a,s)}function jt(o,a,s,f){var b=ct(s,f,!0);b.OrdinaryDefineOwnMetadata(o,a,s,f)}function Rt(o,a){var s=Bt(o,a),f=_t(o);if(f===null)return s;var b=Rt(f,a);if(b.length<=0)return s;if(s.length<=0)return b;for(var I=new tt,G=[],_=0,u=s;_<u.length;_++){var l=u[_],h=I.has(l);h||(I.add(l),G.push(l))}for(var m=0,k=b;m<k.length;m++){var l=k[m],h=I.has(l);h||(I.add(l),G.push(l))}return G}function Bt(o,a){var s=ct(o,a,!1);return s?s.OrdinaryOwnMetadataKeys(o,a):[]}function Ht(o){if(o===null)return 1;switch(typeof o){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return o===null?1:6;default:return 6}}function x(o){return o===void 0}function ot(o){return o===null}function ge(o){return typeof o=="symbol"}function z(o){return typeof o=="object"?o!==null:typeof o=="function"}function me(o,a){switch(Ht(o)){case 0:return o;case 1:return o;case 2:return o;case 3:return o;case 4:return o;case 5:return o}var s="string",f=qt(o,d);if(f!==void 0){var b=f.call(o,s);if(z(b))throw new TypeError;return b}return ye(o)}function ye(o,a){var s,f,b;{var I=o.toString;if(vt(I)){var f=I.call(o);if(!z(f))return f}var s=o.valueOf;if(vt(s)){var f=s.call(o);if(!z(f))return f}}throw new TypeError}function Ft(o){return!!o}function ve(o){return""+o}function V(o){var a=me(o);return ge(a)?a:ve(a)}function Ut(o){return Array.isArray?Array.isArray(o):o instanceof Object?o instanceof Array:Object.prototype.toString.call(o)==="[object Array]"}function vt(o){return typeof o=="function"}function Wt(o){return typeof o=="function"}function we(o){switch(Ht(o)){case 3:return!0;case 4:return!0;default:return!1}}function Mt(o,a){return o===a||o!==o&&a!==a}function qt(o,a){var s=o[a];if(s!=null){if(!vt(s))throw new TypeError;return s}}function Qt(o){var a=qt(o,y);if(!vt(a))throw new TypeError;var s=a.call(o);if(!z(s))throw new TypeError;return s}function Jt(o){return o.value}function Zt(o){var a=o.next();return a.done?!1:a}function Xt(o){var a=o.return;a&&a.call(o)}function _t(o){var a=Object.getPrototypeOf(o);if(typeof o!="function"||o===g||a!==g)return a;var s=o.prototype,f=s&&Object.getPrototypeOf(s);if(f==null||f===Object.prototype)return a;var b=f.constructor;return typeof b!="function"||b===o?a:b}function be(){var o;!x(L)&&typeof r.Reflect<"u"&&!(L in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(o=Ae(r.Reflect));var a,s,f,b=new st,I={registerProvider:G,getProvider:u,setProvider:h};return I;function G(m){if(!Object.isExtensible(I))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case o===m:break;case x(a):a=m;break;case a===m:break;case x(s):s=m;break;case s===m:break;default:f===void 0&&(f=new tt),f.add(m);break}}function _(m,k){if(!x(a)){if(a.isProviderFor(m,k))return a;if(!x(s)){if(s.isProviderFor(m,k))return a;if(!x(f))for(var D=Qt(f);;){var N=Zt(D);if(!N)return;var Y=Jt(N);if(Y.isProviderFor(m,k))return Xt(D),Y}}}if(!x(o)&&o.isProviderFor(m,k))return o}function u(m,k){var D=b.get(m),N;return x(D)||(N=D.get(k)),x(N)&&(N=_(m,k),x(N)||(x(D)&&(D=new Q,b.set(m,D)),D.set(k,N))),N}function l(m){if(x(m))throw new TypeError;return a===m||s===m||!x(f)&&f.has(m)}function h(m,k,D){if(!l(D))throw new Error("Metadata provider not registered.");var N=u(m,k);if(N!==D){if(!x(N))return!1;var Y=b.get(m);x(Y)&&(Y=new Q,b.set(m,Y)),Y.set(k,D)}return!0}}function xe(){var o;return!x(L)&&z(r.Reflect)&&Object.isExtensible(r.Reflect)&&(o=r.Reflect[L]),x(o)&&(o=be()),!x(L)&&z(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,L,{enumerable:!1,configurable:!1,writable:!1,value:o}),o}function Se(o){var a=new st,s={isProviderFor:function(l,h){var m=a.get(l);return x(m)?!1:m.has(h)},OrdinaryDefineOwnMetadata:G,OrdinaryHasOwnMetadata:b,OrdinaryGetOwnMetadata:I,OrdinaryOwnMetadataKeys:_,OrdinaryDeleteMetadata:u};return H.registerProvider(s),s;function f(l,h,m){var k=a.get(l),D=!1;if(x(k)){if(!m)return;k=new Q,a.set(l,k),D=!0}var N=k.get(h);if(x(N)){if(!m)return;if(N=new Q,k.set(h,N),!o.setProvider(l,h,s))throw k.delete(h),D&&a.delete(l),new Error("Wrong provider for target.")}return N}function b(l,h,m){var k=f(h,m,!1);return x(k)?!1:Ft(k.has(l))}function I(l,h,m){var k=f(h,m,!1);if(!x(k))return k.get(l)}function G(l,h,m,k){var D=f(m,k,!0);D.set(l,h)}function _(l,h){var m=[],k=f(l,h,!1);if(x(k))return m;for(var D=k.keys(),N=Qt(D),Y=0;;){var Yt=Zt(N);if(!Yt)return m.length=Y,m;var Ce=Jt(Yt);try{m[Y]=Ce}catch(Le){try{Xt(N)}finally{throw Le}}Y++}}function u(l,h,m){var k=f(h,m,!1);if(x(k)||!k.delete(l))return!1;if(k.size===0){var D=a.get(h);x(D)||(D.delete(m),D.size===0&&a.delete(D))}return!0}}function Ae(o){var a=o.defineMetadata,s=o.hasOwnMetadata,f=o.getOwnMetadata,b=o.getOwnMetadataKeys,I=o.deleteMetadata,G=new st,_={isProviderFor:function(u,l){var h=G.get(u);return!x(h)&&h.has(l)?!0:b(u,l).length?(x(h)&&(h=new tt,G.set(u,h)),h.add(l),!0):!1},OrdinaryDefineOwnMetadata:a,OrdinaryHasOwnMetadata:s,OrdinaryGetOwnMetadata:f,OrdinaryOwnMetadataKeys:b,OrdinaryDeleteMetadata:I};return _}function ct(o,a,s){var f=H.getProvider(o,a);if(!x(f))return f;if(s){if(H.setProvider(o,a,F))return F;throw new Error("Illegal state.")}}function Me(){var o={},a=[],s=function(){function _(u,l,h){this._index=0,this._keys=u,this._values=l,this._selector=h}return _.prototype["@@iterator"]=function(){return this},_.prototype[y]=function(){return this},_.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var l=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=a,this._values=a):this._index++,{value:l,done:!1}}return{value:void 0,done:!0}},_.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=a,this._values=a),u},_.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=a,this._values=a),{value:u,done:!0}},_}(),f=function(){function _(){this._keys=[],this._values=[],this._cacheKey=o,this._cacheIndex=-2}return Object.defineProperty(_.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),_.prototype.has=function(u){return this._find(u,!1)>=0},_.prototype.get=function(u){var l=this._find(u,!1);return l>=0?this._values[l]:void 0},_.prototype.set=function(u,l){var h=this._find(u,!0);return this._values[h]=l,this},_.prototype.delete=function(u){var l=this._find(u,!1);if(l>=0){for(var h=this._keys.length,m=l+1;m<h;m++)this._keys[m-1]=this._keys[m],this._values[m-1]=this._values[m];return this._keys.length--,this._values.length--,Mt(u,this._cacheKey)&&(this._cacheKey=o,this._cacheIndex=-2),!0}return!1},_.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=o,this._cacheIndex=-2},_.prototype.keys=function(){return new s(this._keys,this._values,b)},_.prototype.values=function(){return new s(this._keys,this._values,I)},_.prototype.entries=function(){return new s(this._keys,this._values,G)},_.prototype["@@iterator"]=function(){return this.entries()},_.prototype[y]=function(){return this.entries()},_.prototype._find=function(u,l){if(!Mt(this._cacheKey,u)){this._cacheIndex=-1;for(var h=0;h<this._keys.length;h++)if(Mt(this._keys[h],u)){this._cacheIndex=h;break}}return this._cacheIndex<0&&l&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},_}();return f;function b(_,u){return _}function I(_,u){return u}function G(_,u){return[_,u]}}function _e(){var o=function(){function a(){this._map=new Q}return Object.defineProperty(a.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),a.prototype.has=function(s){return this._map.has(s)},a.prototype.add=function(s){return this._map.set(s,s),this},a.prototype.delete=function(s){return this._map.delete(s)},a.prototype.clear=function(){this._map.clear()},a.prototype.keys=function(){return this._map.keys()},a.prototype.values=function(){return this._map.keys()},a.prototype.entries=function(){return this._map.entries()},a.prototype["@@iterator"]=function(){return this.keys()},a.prototype[y]=function(){return this.keys()},a}();return o}function ke(){var o=16,a=C.create(),s=f();return function(){function u(){this._key=f()}return u.prototype.has=function(l){var h=b(l,!1);return h!==void 0?C.has(h,this._key):!1},u.prototype.get=function(l){var h=b(l,!1);return h!==void 0?C.get(h,this._key):void 0},u.prototype.set=function(l,h){var m=b(l,!0);return m[this._key]=h,this},u.prototype.delete=function(l){var h=b(l,!1);return h!==void 0?delete h[this._key]:!1},u.prototype.clear=function(){this._key=f()},u}();function f(){var u;do u="@@WeakMap@@"+_();while(C.has(a,u));return a[u]=!0,u}function b(u,l){if(!i.call(u,s)){if(!l)return;Object.defineProperty(u,s,{value:C.create()})}return u[s]}function I(u,l){for(var h=0;h<l;++h)u[h]=Math.random()*255|0;return u}function G(u){if(typeof Uint8Array=="function"){var l=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(l):typeof msCrypto<"u"?msCrypto.getRandomValues(l):I(l,u),l}return I(new Array(u),u)}function _(){var u=G(o);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var l="",h=0;h<o;++h){var m=u[h];(h===4||h===6||h===8)&&(l+="-"),m<16&&(l+="0"),l+=m.toString(16).toLowerCase()}return l}}function kt(o){return o.__=void 0,delete o.__,o}})}(t||(t={})),Vt}Ee();var A=(t=>(t[t.Common=0]="Common",t[t.Rare=1]="Rare",t[t.Epic=2]="Epic",t[t.Legendary=3]="Legendary",t[t.Unique=4]="Unique",t))(A||{}),$t=(t=>(t.Consumable="consumable",t.Equipment="equipment",t))($t||{}),Pt=(t=>(t.None="",t.Big="巨大的",t.Smelly="野兽先辈的",t))(Pt||{}),nt=(t=>(t.Head="head",t.Body="body",t.Hand="hand",t.Foot="foot",t.Accessory="accessory",t))(nt||{}),p=(t=>(t.Attack="attack",t.Defend="defend",t.Dodge="dodge",t.Capture="capture",t.DexAction="dexAction",t.StrAction="strAction",t.IntAction="intAction",t.ConAction="conAction",t.SizAction="sizAction",t.AppAction="appAction",t.NoAction="noAction",t))(p||{}),ce=(t=>(t.Poison="poison",t.Sleep="sleep",t.Stun="stun",t.Confuse="confuse",t.Paralyze="paralyze",t.Pain="pain",t))(ce||{}),v=(t=>(t.Dazed="Dazed",t.Attack="Attack",t.PowerAttack="PowerAttack",t.QuickAttack="QuickAttack",t.PowerfulDigAttack="PowerfulDigAttack",t.HorizontalSlash="HorizontalSlash",t.Bite="Bite",t.Capture="Capture",t.Stun="Stun",t.Defend="Defend",t.Dodge="Dodge",t.DragonBreath="DragonBreath",t.SpinAttack="SpinAttack",t.DefenseSlash="DefenseSlash",t.Counter="Counter",t.GodStrike="GodStrike",t.ShredFlower="ShredFlower",t.PsyKick="PsyKick",t.PsyExplosion="PsyExplosion",t.PsyInvisibleSword="PsyInvisibleSword",t.PsyDodge="PsyDodge",t))(v||{});const ee={category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 来不及反应`},ne={Dazed:{name:"反应不过来",description:"来不及反应",rarity:A.Common,hits:[{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 来不及反应`}]},Stun:{name:"眩晕",description:"眩晕",rarity:A.Common,hits:[{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 眩晕了`}]},Attack:{name:"攻击",description:"用拳头或者用武器进行一般通过攻击",rarity:A.Common,hits:[{category:p.Attack,coeff:{str:1,int:0,con:0,siz:.5,app:0,dex:.5},messageGenerator:(t,e)=>`${t.name}攻击了${e.name}`}]},PowerAttack:{name:"强力攻击",description:"全身力量集中于一点，进行一次强力的攻击",rarity:A.Rare,hits:[{category:p.Attack,coeff:{str:2,int:0,con:0,siz:.5,app:0,dex:.5},messageGenerator:(t,e)=>`${t.name}对${e.name}发起了一次强力的攻击`}]},QuickAttack:{name:"迅击",description:"据说剑圣在一个呼吸间就能劈出数刀。虽然你不是剑圣，但你努努力也至少能劈出两刀",rarity:A.Rare,hits:[{category:p.Attack,coeff:{str:.5,int:0,con:0,siz:0,app:0,dex:1},messageGenerator:(t,e)=>`${t.name}以迅雷不及掩耳之势向${e.name}发起了攻势`},{category:p.Attack,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:1},messageGenerator:(t,e)=>`电光火石之间，${t.name}再次做出了攻击`}]},PowerfulDigAttack:{name:"狠狠地撅",description:"1！1！4！5！1！4！",rarity:A.Legendary,hits:[{category:p.Attack,coeff:{str:6,int:0,con:0,siz:3,app:0,dex:0},extraEffect:(t,e)=>{e.status.push({type:ce.Pain,duration:10})},messageGenerator:(t,e)=>`${t.name}狠狠地撅了${e.name}一下，${e.name}痛苦难耐
// 哼哼啊啊啊啊啊啊啊啊啊啊 `}]},HorizontalSlash:{name:"横劈",description:"以迅猛之势横向劈出一刀",rarity:A.Epic,hits:[{category:p.Attack,coeff:{str:2,int:0,con:0,siz:0,app:0,dex:2},messageGenerator:(t,e)=>`${t.name}以迅猛之势横向劈出一刀`}]},Bite:{name:"撕咬",description:"野兽的原始攻击方式",rarity:A.Common,hits:[{category:p.Attack,coeff:{str:1,int:0,con:0,siz:.5,app:0,dex:1},messageGenerator:(t,e)=>`${t.name}冲过来咬了${e.name}一口`}]},Capture:{name:"尝试捕捉",description:"这不是神奇宝贝，你得用绞技而不是精灵球",rarity:A.Common,hits:[{category:p.Capture,coeff:{str:.5,int:0,con:0,siz:0,app:0,dex:.5},extraEffect:(t,e)=>{if(!(t instanceof wt))return;if(e.health<1){t.addLog(`${e.name}已经死了，无法捕获`);return}const n=t.ability.dex/e.ability.dex*(t.ability.siz/e.ability.siz)/(10*e.health/e.maxHealth),r=t.ability.str/e.ability.str*(t.ability.siz/e.ability.siz)/(10*e.health/e.maxHealth);Math.random()<r&&Math.random()<n?(e.health=.9,t.capturedMonster.push(e),t.addLog(`你成功捕获了${e.name}`)):t.addLog(`你尝试捕获${e.name}，但是失败了`)},messageGenerator:(t,e)=>`${t.name}尝试通过绞住${e.name}，让${e.name}失去行动力`}]},Defend:{name:"格挡",description:"做一个稳重的人",rarity:A.Common,hits:[{category:p.Defend,coeff:{str:1,int:0,con:1,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 进行了防御`}]},Counter:{name:"反击",description:"格挡后乘势反击",rarity:A.Rare,hits:[{category:p.Defend,coeff:{str:.5,int:0,con:1,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 进行了防御`},{category:p.Attack,coeff:{str:.5,int:0,con:0,siz:0,app:0,dex:1},messageGenerator:(t,e)=>`${t.name} 进行了反击`}]},DefenseSlash:{name:"防御斩",description:"快速挥刀后立刻进行防御，不给敌人任何可乘之机",rarity:A.Rare,hits:[{category:p.Attack,coeff:{str:.5,int:0,con:0,siz:0,app:0,dex:1},messageGenerator:(t,e)=>`${t.name} 进行了一次快速攻击`},{category:p.Defend,coeff:{str:1.5,int:0,con:1.5,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 进行了铁壁一般的防御`}]},Dodge:{name:"闪避",description:"天下武功，唯快不破。若是能闪过敌人的攻击，将使敌人失衡，失去下一个动作",rarity:A.Common,hits:[{category:p.Dodge,coeff:{str:0,int:0,con:0,siz:-1.5,app:0,dex:3},messageGenerator:(t,e)=>`${t.name} 进行了躲闪`}]},PsyDodge:{name:"瞬移",description:"念力的一种用法",rarity:A.Legendary,hits:[{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>"一切如常"},{category:p.Dodge,coeff:{str:0,int:12,con:0,siz:0,app:0,dex:3},messageGenerator:(t,e)=>`${t.name} 的身影瞬间到了别处`}]},SpinAttack:{name:"回旋击",description:"闪避后趁敌人重心不稳发起攻击",rarity:A.Rare,hits:[{category:p.Dodge,coeff:{str:0,int:0,con:0,siz:-1.5,app:0,dex:2.5},messageGenerator:(t,e)=>`${t.name} 进行了躲闪`},{category:p.Attack,coeff:{str:1,int:0,con:0,siz:0,app:0,dex:1},messageGenerator:(t,e)=>`${t.name} 进行了回旋击`}]},DragonBreath:{name:"巨龙吐息",description:"据说巨龙的吐息足以融化钢铁",rarity:A.Legendary,hits:[{category:p.Attack,coeff:{str:0,int:10,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 喷出了汹涌的火焰`},{category:p.Attack,coeff:{str:0,int:5,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 喷出了灼热的火焰`},{category:p.Attack,coeff:{str:0,int:2,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${t.name} 喷出了喉咙中残余的火焰`}]},GodStrike:{name:"神击",description:"犹如神灵降下天罚",rarity:A.Unique,hits:[{category:p.Attack,coeff:{str:12,int:6,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`神明的愤怒降临于${e.name}`}]},ShredFlower:{name:"碎花",description:"无人能看清动作，空中轻柔的落花瞬间化为齑粉",rarity:A.Unique,hits:[{category:p.Defend,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:6},messageGenerator:(t,e)=>`${e.name} 被花瓣包围了`},{category:p.Dodge,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:6},messageGenerator:(t,e)=>`${t.name} 的身影消失了`},{category:p.Attack,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:4},messageGenerator:(t,e)=>"空气中只有残影"},{category:p.Attack,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:4},messageGenerator:(t,e)=>"空气中只有更多的残影"},{category:p.Attack,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:3},messageGenerator:(t,e)=>`${e.name} 同花瓣一同破碎`}]},PsyKick:{name:"念动力踢击",description:"通过念力完成的隔空踢击，力道十足又难以防备",rarity:A.Rare,hits:[{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>"一切如常"},{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>"一切如常"},{category:p.Attack,coeff:{str:2,int:6,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${e.name}凭空被踢了一脚`}]},PsyExplosion:{name:"不可视爆裂",description:"不可视的念力凝聚成万吨重锤从天而降",rarity:A.Legendary,hits:[{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>"一切如常"},{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>"一切如常"},{category:p.Attack,coeff:{str:4,int:12,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`${e.name}所在的位置发生了大爆炸`}]},PsyInvisibleSword:{name:'"不可视之剑"',description:"无数看不见的剑刺向敌人，流淌的血勾勒出它们的形状",rarity:A.Unique,hits:[{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>"一切如常"},{category:p.NoAction,coeff:{str:0,int:0,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>"一切如常"},{category:p.Attack,coeff:{str:0,int:2,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`看不见的剑贯穿${e.name}`},{category:p.Attack,coeff:{str:0,int:4,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`更多看不见的剑贯穿${e.name}`},{category:p.Attack,coeff:{str:0,int:8,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`极多看不见的剑贯穿${e.name}`},{category:p.Attack,coeff:{str:0,int:16,con:0,siz:0,app:0,dex:0},messageGenerator:(t,e)=>`无数看不见的剑贯穿${e.name}`}]}};var zt=(t=>(t.Sword="Sword",t.Katana="Katana",t.WindSpinSword="WindSpinSword",t.AyulsaOfNoHonor="AyulsaOfNoHonor",t.RockSword="RockSword",t.Rope="Rope",t.DragonSlayer="DragonSlayer",t))(zt||{});const Et={Sword:{name:"剑",description:"一把剑,平平无奇的武器",rarity:A.Common,position:nt.Hand,extraActions:[{actionType:v.Attack,weight:.3},{actionType:v.PowerAttack,weight:.2}],ability:{},actionCoeff:{[p.Attack]:{plus:1,multiply:1}}},Rope:{name:"绳索",description:"绳索,看起来很适合用来捕捉",rarity:A.Common,position:nt.Hand,extraActions:[{actionType:v.Capture,weight:.2}],ability:{},actionCoeff:{[p.Attack]:{plus:-1,multiply:0},[p.Capture]:{plus:2,multiply:1}}},Katana:{name:"太刀",description:"太好了，有了这个，你就可以做虾头太刀侠了",rarity:A.Rare,position:nt.Hand,extraActions:[{actionType:v.HorizontalSlash,weight:1}],ability:{str:1,dex:-1},actionCoeff:{[p.Attack]:{plus:2,multiply:1},[p.Dodge]:{plus:-2,multiply:1},[p.DexAction]:{plus:-2,multiply:1}}},WindSpinSword:{name:"风旋刺剑",description:"靠近剑身能听到轻轻的风声",rarity:A.Epic,position:nt.Hand,extraActions:[{actionType:v.QuickAttack,weight:.4},{actionType:v.Dodge,weight:.2},{actionType:v.SpinAttack,weight:.4}],ability:{dex:2},actionCoeff:{[p.Attack]:{plus:1,multiply:1},[p.Dodge]:{plus:2,multiply:1},[p.DexAction]:{plus:2,multiply:1}}},RockSword:{name:"剑型大石头",description:"一把很宽的石头大剑，看起来就像块大石头",rarity:A.Epic,position:nt.Hand,extraActions:[{actionType:v.DefenseSlash,weight:.4},{actionType:v.Defend,weight:.2},{actionType:v.Counter,weight:.4},{actionType:v.PowerAttack,weight:.2}],ability:{str:1,con:1},actionCoeff:{[p.Attack]:{plus:2,multiply:1},[p.Defend]:{plus:3,multiply:1}}},DragonSlayer:{name:"弑龙者",description:"传说这把剑上的龙之力来源于被它杀死的龙",rarity:A.Legendary,position:nt.Hand,extraActions:[{actionType:v.HorizontalSlash,weight:1},{actionType:v.DragonBreath,weight:.5}],ability:{str:1,con:2},actionCoeff:{[p.Attack]:{plus:3,multiply:1.1}}},AyulsaOfNoHonor:{name:"Ayulsa死于徒手",description:"Ayulsa手上没有武器",rarity:A.Unique,position:nt.Hand,extraActions:[{actionType:v.PsyKick,weight:.2},{actionType:v.PsyExplosion,weight:1},{actionType:v.PsyInvisibleSword,weight:.2},{actionType:v.PsyDodge,weight:.6}],ability:{int:2,dex:2},actionCoeff:{}}};class de{constructor(e,n,r,i,c,d){O(this,"name");O(this,"uuid");O(this,"category");O(this,"type");O(this,"rarity");O(this,"description");this.name=e,this.uuid=n,this.category=r,this.type=i,this.rarity=c,this.description=d}}const U=[];for(let t=0;t<256;++t)U.push((t+256).toString(16).slice(1));function Te(t,e=0){return(U[t[e+0]]+U[t[e+1]]+U[t[e+2]]+U[t[e+3]]+"-"+U[t[e+4]]+U[t[e+5]]+"-"+U[t[e+6]]+U[t[e+7]]+"-"+U[t[e+8]]+U[t[e+9]]+"-"+U[t[e+10]]+U[t[e+11]]+U[t[e+12]]+U[t[e+13]]+U[t[e+14]]+U[t[e+15]]).toLowerCase()}let Ct;const De=new Uint8Array(16);function Ie(){if(!Ct){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ct=crypto.getRandomValues.bind(crypto)}return Ct(De)}const Ne=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),re={randomUUID:Ne};function fe(t,e,n){var i;if(re.randomUUID&&!t)return re.randomUUID();t=t||{};const r=t.random??((i=t.rng)==null?void 0:i.call(t))??Ie();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Te(r)}class ue extends de{constructor(n){n=n||zt.Sword;const r=Et[n];super(r.name,fe(),$t.Equipment,n,r.rarity,r.description);O(this,"position");O(this,"extraActions");O(this,"ability");O(this,"actionCoeff");O(this,"prefix");this.position=r.position,this.extraActions=r.extraActions,this.ability=r.ability,this.actionCoeff=r.actionCoeff,this.prefix=$e()}}function $e(){return Object.values(Pt)[Math.floor(Math.random()*Object.values(Pt).length)]}function ze(t){const e=Object.keys(Et).filter(i=>Et[i].rarity===t),n=Math.floor(Math.random()*e.length),r=e[n];return new ue(r)}function dt(t,e){return Math.random()<.1?e-=1:Math.random()<.05&&(e+=1),e=e<A.Common?A.Common:e,e=e>A.Unique?A.Unique:e,ze(e)}var B=(t=>(t.Unknown="Unknown",t.BrokenChest="BrokenChest",t.WoodenChest="WoodenChest",t.SilverChest="SilverChest",t.GoldChest="GoldChest",t.DiamondChest="DiamondChest",t))(B||{});const oe={BrokenChest:{name:"破烂的木宝箱",rarity:A.Common,description:"一个破破烂烂的宝箱",effect:t=>{t.pack.push(dt(1,A.Common))}},WoodenChest:{name:"木质的宝箱",rarity:A.Rare,description:"一个有着漂亮的木质纹理的宝箱",effect:t=>{t.pack.push(dt(1,A.Rare))}},SilverChest:{name:"银色装饰的宝箱",rarity:A.Epic,description:"这个宝箱上有着精细的银制装饰，银锈并不能掩盖它的华丽",effect:t=>{t.pack.push(dt(1,A.Epic))}},GoldChest:{name:"黄金镶边的宝箱",rarity:A.Legendary,description:"金光闪闪，这才叫宝箱！光是看着就让人心潮澎湃",effect:t=>{t.pack.push(dt(1,A.Legendary))}},DiamondChest:{name:"华丽的宝石宝箱",rarity:A.Unique,description:"无法用辞藻形容的华丽，你甚至害怕打开它会划伤上面美丽的宝石",effect:t=>{t.pack.push(dt(1,A.Unique))}},Unknown:{name:"未知",rarity:A.Common,description:"未知",effect:t=>{}}};var Z=(t=>(t.Player="Player",t.Player114514="Player114514",t.Slime="Slime",t.Dragon="Dragon",t.AngryDragon="AngryDragon",t.WeakDragon="WeakDragon",t.Wolf="Wolf",t.DiscardedGolem="DiscardedGolem",t.Ayulsa="Ayulsa",t))(Z||{});const ft={Player:{typeName:"人类",description:"你",abilityCoeff:{str:{base:5,growth:.1},int:{base:5,growth:.1},con:{base:5,growth:.2},siz:{base:5,growth:0},app:{base:5,growth:0},dex:{base:5,growth:.1},armor:{base:0,growth:0}},actions:[{actionType:v.Attack,weight:.5},{actionType:v.Capture,weight:.1},{actionType:v.Defend,weight:.2},{actionType:v.Dodge,weight:.2}],dropItems:[]},Player114514:{typeName:"野兽仙贝",description:"114514",abilityCoeff:{str:{base:5,growth:.2},int:{base:5,growth:0},con:{base:7,growth:.2},siz:{base:5,growth:.1},app:{base:7,growth:0},dex:{base:5,growth:0},armor:{base:0,growth:0}},actions:[{actionType:v.PowerfulDigAttack,weight:.2},{actionType:v.Attack,weight:.5},{actionType:v.Capture,weight:.1},{actionType:v.Defend,weight:.2},{actionType:v.Dodge,weight:.2}],dropItems:[]},Slime:{typeName:"史莱姆",description:"一种行动缓慢的软体生物，武器打上去没有什么手感",abilityCoeff:{str:{base:3,growth:.05},int:{base:0,growth:0},con:{base:3,growth:.1},siz:{base:2,growth:0},app:{base:0,growth:0},dex:{base:1,growth:.05},armor:{base:50,growth:1}},actions:[{actionType:v.Attack,weight:1},{actionType:v.Defend,weight:1},{actionType:v.Dazed,weight:2}],dropItems:[{type:B.BrokenChest,weight:.98},{type:B.WoodenChest,weight:.02},{type:B.SilverChest,weight:.001}]},Dragon:{typeName:"龙",description:"生态位的顶端，人类在它庞大的身躯面前就像一只蝼蚁。它正用着锐利的目光打量着你，让你不寒而栗",abilityCoeff:{str:{base:10,growth:.2},int:{base:4,growth:.1},con:{base:20,growth:.8},siz:{base:20,growth:.2},app:{base:4,growth:.1},dex:{base:4,growth:.1},armor:{base:50,growth:10}},actions:[{actionType:v.Bite,weight:.1},{actionType:v.PowerAttack,weight:.2},{actionType:v.Counter,weight:.2},{actionType:v.DragonBreath,weight:.2},{actionType:v.QuickAttack,weight:.2},{actionType:v.Defend,weight:.1}],dropItems:[]},AngryDragon:{typeName:"愤怒的龙",description:"龙彻底被激怒了，一只蝼蚁居然让它受了伤。它有些虚弱，但是攻击更加狂暴了",abilityCoeff:{str:{base:15,growth:.3},int:{base:3,growth:.05},con:{base:10,growth:.4},siz:{base:20,growth:.2},app:{base:2,growth:.05},dex:{base:6,growth:.15},armor:{base:25,growth:5}},actions:[{actionType:v.Bite,weight:.1},{actionType:v.PowerAttack,weight:.2},{actionType:v.DragonBreath,weight:.2},{actionType:v.QuickAttack,weight:.2}],dropItems:[]},WeakDragon:{typeName:"虚弱的龙",description:"它抛弃了自己作为龙的尊严，现在一心只想活下去",abilityCoeff:{str:{base:5,growth:.1},int:{base:6,growth:.15},con:{base:5,growth:.2},siz:{base:20,growth:.2},app:{base:2,growth:.05},dex:{base:4,growth:.1},armor:{base:20,growth:3}},actions:[{actionType:v.Bite,weight:.2},{actionType:v.Counter,weight:.3},{actionType:v.DragonBreath,weight:.2},{actionType:v.Defend,weight:.3}],dropItems:[{type:B.SilverChest,weight:.98},{type:B.GoldChest,weight:.02},{type:B.DiamondChest,weight:.001}]},Wolf:{typeName:"孤狼",description:"一匹行动敏捷的孤狼，对于普通人来说，它是一种危险的生物",abilityCoeff:{str:{base:5,growth:.1},int:{base:2,growth:.05},con:{base:5,growth:.15},siz:{base:4,growth:.05},app:{base:2,growth:0},dex:{base:6,growth:.15},armor:{base:0,growth:1}},actions:[{actionType:v.Bite,weight:1},{actionType:v.QuickAttack,weight:.5},{actionType:v.SpinAttack,weight:.5}],dropItems:[{type:B.BrokenChest,weight:.5},{type:B.WoodenChest,weight:.5},{type:B.SilverChest,weight:.01},{type:B.GoldChest,weight:.001}]},DiscardedGolem:{typeName:"废弃的岩石魔像",description:"一尊不知何时被废弃的岩石魔像，在风雨的侵蚀下，它的巨大的身躯上布满了裂痕和苔藓。它不该会动呀？",abilityCoeff:{str:{base:15,growth:.3},int:{base:0,growth:0},con:{base:10,growth:.4},siz:{base:15,growth:0},app:{base:0,growth:0},dex:{base:0,growth:0},armor:{base:100,growth:0}},actions:[{actionType:v.Dazed,weight:2},{actionType:v.Defend,weight:1},{actionType:v.PowerAttack,weight:.5},{actionType:v.Counter,weight:.5}],dropItems:[{type:B.BrokenChest,weight:.2},{type:B.WoodenChest,weight:.8},{type:B.SilverChest,weight:.04},{type:B.GoldChest,weight:.004}]},Ayulsa:{typeName:"???",description:"好像并不来自于这个世界",abilityCoeff:{str:{base:5,growth:.2},int:{base:50,growth:.2},con:{base:5,growth:.4},siz:{base:5,growth:.2},app:{base:5,growth:.2},dex:{base:5,growth:.2},armor:{base:0,growth:.2}},actions:[{actionType:v.GodStrike,weight:1},{actionType:v.ShredFlower,weight:1}],dropItems:[{type:B.DiamondChest,weight:1}]}};class pe{constructor(e,n,r,i){O(this,"name");O(this,"type");O(this,"level");O(this,"individualStrength");O(this,"maxHealth");O(this,"health");O(this,"ability");O(this,"status",[]);O(this,"pack",[]);O(this,"actions");this.name=e,this.type=n,this.level=r,this.individualStrength=i;const c=ft[this.type].abilityCoeff,d=(y,w,P)=>{const S=Math.random()**.5;return y.base+y.growth*w*P*S};this.ability={str:d(c.str,r,i),int:d(c.int,r,i),con:d(c.con,r,i),siz:d(c.siz,r,i),app:d(c.app,r,i),dex:d(c.dex,r,i),armor:d(c.armor,r,i)},this.health=this.ability.con*10+this.ability.siz*5,this.maxHealth=this.health,this.actions=ft[this.type].actions}getRandomAction(){const e=Math.random(),n=this.actions.reduce((i,c)=>i+c.weight,0);let r=0;for(const i of this.actions)if(r+=i.weight,e<r/n)return ne[i.actionType];return ne[v.Dazed]}}class wt extends pe{constructor(n,r){n=n||"吴田所",r=r||Z.Player;super(n,r,0,1);O(this,"log",[]);O(this,"tempLog",[]);O(this,"capturedMonster",[]);O(this,"isAtHome",!0)}getHealthDisplay(){const n=this.ability.con/5*this.maxHealth/900;return`hp: ${this.health.toFixed(2)} / ${this.maxHealth.toFixed(0)} + ${n.toFixed(2)}/s`}updateHealthDisplay(){const n=document.getElementById("health-display");n&&(n.innerText=this.getHealthDisplay())}autoRecoverHpDot(){const n=this.ability.con/5*this.maxHealth/900;this.health=Math.min(this.health+n,this.maxHealth)}levelup(){this.level++}addLog(n){this.log.push(n)}getLogs(){return this.log.join("<br>")}getLastNLog(n){return this.log.slice(-n).join("<br>")}addTempLog(n){this.tempLog.push(n)}getTempLogs(){return this.tempLog.join("<br>")}clearTempLogs(){this.tempLog=[]}joinTempLogs(){this.log.push(this.tempLog.join("<br>")),this.tempLog=[]}}function et(){const t=document.getElementById("app");if(!t)throw new Error("无法找到挂载点 #app");return t}class Tt extends de{constructor(e){e=e||B.Unknown;const n=oe[e];super(n.name,fe(),$t.Consumable,e,n.rarity,n.description)}useItem(e){oe[this.type].effect(e),e.pack=e.pack.filter(n=>n.uuid!==this.uuid)}}function Ge(t){if(t in B)return new Tt(t);if(t in zt)return new ue(t);throw new Error("Invalid item type")}class je extends pe{constructor(n,r,i,c){n=n||"怪物",r=r||Z.Slime,i=i||1,c=c||1;super(n,r,i,c);O(this,"description");O(this,"dropItems");this.dropItems=ft[r].dropItems,this.description=ft[r].description}randomDropItem(){const n=this.dropItems[Math.floor(Math.random()*this.dropItems.length)].type;return Ge(n)}}function Dt(t,e){return t.str*e.str+t.dex*e.dex+t.int*e.int+t.con*e.con+t.siz*e.siz+t.app*e.app}function ut(t,e){return(t.str*e.str+t.dex*e.dex+t.int*e.int+t.con*e.con+t.siz*e.siz+t.app*e.app)*Math.random()}function bt(t,e){return t*(25/(e+25))}function Re(t,e,n,r){const i=ut(n.coeff,t.ability),c=ut(r.coeff,e.ability);if(t.addTempLog(t.name+'<span style="color: blue;">'+Math.round(i)+"</span>"+e.name+'<span style="color: orange;">'+Math.round(c)+"</span>"),i>=c){const d=bt(i,e.ability.armor);e.health-=d,t.addTempLog(n.messageGenerator(t,e)+'造成了<span style="color: red;">'+Math.round(d)+"</span>点伤害"),n.extraEffect&&n.extraEffect(t,e)}else{const d=bt(c,t.ability.armor);t.health-=d,t.addTempLog(r.messageGenerator(e,t)+'造成了<span style="color: red;">'+Math.round(d)+"</span>点伤害"),r.extraEffect&&r.extraEffect(e,t)}}function Be(t,e,n,r){let i,c,d;r.category===p.NoAction?(i=t,c=e,d=n):(i=e,c=t,d=r);const y=ut(d.coeff,i.ability);t.addTempLog(i.name+'<span style="color: blue;">'+Math.round(y)+"</span>"+c.name+"无动作");const w=bt(y,c.ability.armor);c.health-=w,t.addTempLog(d.messageGenerator(i,c)+'造成了<span style="color: red;">'+Math.round(w)+"</span>点伤害"),d.extraEffect&&d.extraEffect(i,c)}function He(t,e,n,r){const i=ut(n.coeff,t.ability),c=ut(r.coeff,e.ability);t.addTempLog(t.name+'<span style="color: blue;">'+Math.round(i)+"</span>"+e.name+'<span style="color: orange;">'+Math.round(c)+"</span>");const d=n.category!==p.Defend,y=d?t:e,w=d?e:t,P=d?n:r,S=d?r:n,C=d?i:c,g=d?c:i,Q=C-g>0?C-g:0,tt=bt(Q,w.ability.armor);w.health-=tt,Q>0?t.addTempLog(S.messageGenerator(w,y)+","+P.messageGenerator(y,w)+'造成了<span style="color: red;">'+Math.round(tt)+"</span>点伤害"):t.addTempLog(S.messageGenerator(w,y)+","+P.messageGenerator(y,w)+"但没有造成伤害")}function Fe(t,e,n,r){t.addTempLog(t.name+"使用了"+n.name+"，"+e.name+"使用了"+r.name);let i=0;for(;n.hits[i]||r.hits[i];){const c=n.hits[i]||ee,d=r.hits[i]||ee;c.category===p.Capture&&(c.category=p.Attack),c.category===p.Attack&&d.category===p.Attack&&Re(t,e,c,d),(c.category===p.Attack&&d.category===p.NoAction||c.category===p.NoAction&&d.category===p.Attack)&&Be(t,e,c,d),(c.category===p.Attack&&d.category===p.Defend||c.category===p.Defend&&d.category===p.Attack)&&He(t,e,c,d),i++}}function Ue(t,e,n){function r(i,c){return i.name+"看起来似乎会"+c.name+"<br>"+c.hits.map(d=>`${d.category}(0~${Math.round(Dt(d.coeff,t.ability))})`).join("<br>")}return Math.random()*t.ability.dex>Math.random()*e.ability.dex?Math.random()*t.ability.int>Math.random()*e.ability.int?r(e,n):r(e,e.getRandomAction()):"你来不及观察"+e.name+"的行动"}var M;(function(t){t[t.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",t[t.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",t[t.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"})(M||(M={}));var We=function(){function t(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return t.prototype.addTypeMetadata=function(e){this._typeMetadatas.has(e.target)||this._typeMetadatas.set(e.target,new Map),this._typeMetadatas.get(e.target).set(e.propertyName,e)},t.prototype.addTransformMetadata=function(e){this._transformMetadatas.has(e.target)||this._transformMetadatas.set(e.target,new Map),this._transformMetadatas.get(e.target).has(e.propertyName)||this._transformMetadatas.get(e.target).set(e.propertyName,[]),this._transformMetadatas.get(e.target).get(e.propertyName).push(e)},t.prototype.addExposeMetadata=function(e){this._exposeMetadatas.has(e.target)||this._exposeMetadatas.set(e.target,new Map),this._exposeMetadatas.get(e.target).set(e.propertyName,e)},t.prototype.addExcludeMetadata=function(e){this._excludeMetadatas.has(e.target)||this._excludeMetadatas.set(e.target,new Map),this._excludeMetadatas.get(e.target).set(e.propertyName,e)},t.prototype.findTransformMetadatas=function(e,n,r){return this.findMetadatas(this._transformMetadatas,e,n).filter(function(i){return!i.options||i.options.toClassOnly===!0&&i.options.toPlainOnly===!0?!0:i.options.toClassOnly===!0?r===M.CLASS_TO_CLASS||r===M.PLAIN_TO_CLASS:i.options.toPlainOnly===!0?r===M.CLASS_TO_PLAIN:!0})},t.prototype.findExcludeMetadata=function(e,n){return this.findMetadata(this._excludeMetadatas,e,n)},t.prototype.findExposeMetadata=function(e,n){return this.findMetadata(this._exposeMetadatas,e,n)},t.prototype.findExposeMetadataByCustomName=function(e,n){return this.getExposedMetadatas(e).find(function(r){return r.options&&r.options.name===n})},t.prototype.findTypeMetadata=function(e,n){return this.findMetadata(this._typeMetadatas,e,n)},t.prototype.getStrategy=function(e){var n=this._excludeMetadatas.get(e),r=n&&n.get(void 0),i=this._exposeMetadatas.get(e),c=i&&i.get(void 0);return r&&c||!r&&!c?"none":r?"excludeAll":"exposeAll"},t.prototype.getExposedMetadatas=function(e){return this.getMetadata(this._exposeMetadatas,e)},t.prototype.getExcludedMetadatas=function(e){return this.getMetadata(this._excludeMetadatas,e)},t.prototype.getExposedProperties=function(e,n){return this.getExposedMetadatas(e).filter(function(r){return!r.options||r.options.toClassOnly===!0&&r.options.toPlainOnly===!0?!0:r.options.toClassOnly===!0?n===M.CLASS_TO_CLASS||n===M.PLAIN_TO_CLASS:r.options.toPlainOnly===!0?n===M.CLASS_TO_PLAIN:!0}).map(function(r){return r.propertyName})},t.prototype.getExcludedProperties=function(e,n){return this.getExcludedMetadatas(e).filter(function(r){return!r.options||r.options.toClassOnly===!0&&r.options.toPlainOnly===!0?!0:r.options.toClassOnly===!0?n===M.CLASS_TO_CLASS||n===M.PLAIN_TO_CLASS:r.options.toPlainOnly===!0?n===M.CLASS_TO_PLAIN:!0}).map(function(r){return r.propertyName})},t.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},t.prototype.getMetadata=function(e,n){var r=e.get(n),i;r&&(i=Array.from(r.values()).filter(function(C){return C.propertyName!==void 0}));for(var c=[],d=0,y=this.getAncestors(n);d<y.length;d++){var w=y[d],P=e.get(w);if(P){var S=Array.from(P.values()).filter(function(C){return C.propertyName!==void 0});c.push.apply(c,S)}}return c.concat(i||[])},t.prototype.findMetadata=function(e,n,r){var i=e.get(n);if(i){var c=i.get(r);if(c)return c}for(var d=0,y=this.getAncestors(n);d<y.length;d++){var w=y[d],P=e.get(w);if(P){var S=P.get(r);if(S)return S}}},t.prototype.findMetadatas=function(e,n,r){var i=e.get(n),c;i&&(c=i.get(r));for(var d=[],y=0,w=this.getAncestors(n);y<w.length;y++){var P=w[y],S=e.get(P);S&&S.has(r)&&d.push.apply(d,S.get(r))}return d.slice().reverse().concat((c||[]).slice().reverse())},t.prototype.getAncestors=function(e){if(!e)return[];if(!this._ancestorsMap.has(e)){for(var n=[],r=Object.getPrototypeOf(e.prototype.constructor);typeof r.prototype<"u";r=Object.getPrototypeOf(r.prototype.constructor))n.push(r);this._ancestorsMap.set(e,n)}return this._ancestorsMap.get(e)},t}(),W=new We;function qe(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self}function Qe(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var ie=function(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,c;r<i;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))};function Je(t){var e=new t;return!(e instanceof Set)&&!("push"in e)?[]:e}var it=function(){function t(e,n){this.transformationType=e,this.options=n,this.recursionStack=new Set}return t.prototype.transform=function(e,n,r,i,c,d){var y=this;if(d===void 0&&(d=0),Array.isArray(n)||n instanceof Set){var w=i&&this.transformationType===M.PLAIN_TO_CLASS?Je(i):[];return n.forEach(function(L,H){var F=e?e[H]:void 0;if(!y.options.enableCircularCheck||!y.isCircular(L)){var j=void 0;if(typeof r!="function"&&r&&r.options&&r.options.discriminator&&r.options.discriminator.property&&r.options.discriminator.subTypes){if(y.transformationType===M.PLAIN_TO_CLASS){j=r.options.discriminator.subTypes.find(function(K){return K.name===L[r.options.discriminator.property]});var J={newObject:w,object:L,property:void 0},E=r.typeFunction(J);j===void 0?j=E:j=j.value,r.options.keepDiscriminatorProperty||delete L[r.options.discriminator.property]}y.transformationType===M.CLASS_TO_CLASS&&(j=L.constructor),y.transformationType===M.CLASS_TO_PLAIN&&(L[r.options.discriminator.property]=r.options.discriminator.subTypes.find(function(K){return K.value===L.constructor}).name)}else j=r;var R=y.transform(F,L,j,void 0,L instanceof Map,d+1);w instanceof Set?w.add(R):w.push(R)}else y.transformationType===M.CLASS_TO_CLASS&&(w instanceof Set?w.add(L):w.push(L))}),w}else{if(r===String&&!c)return n==null?n:String(n);if(r===Number&&!c)return n==null?n:Number(n);if(r===Boolean&&!c)return n==null?n:!!n;if((r===Date||n instanceof Date)&&!c)return n instanceof Date?new Date(n.valueOf()):n==null?n:new Date(n);if(qe().Buffer&&(r===Buffer||n instanceof Buffer)&&!c)return n==null?n:Buffer.from(n);if(Qe(n)&&!c)return new Promise(function(L,H){n.then(function(F){return L(y.transform(void 0,F,r,void 0,void 0,d+1))},H)});if(!c&&n!==null&&typeof n=="object"&&typeof n.then=="function")return n;if(typeof n=="object"&&n!==null){!r&&n.constructor!==Object&&(!Array.isArray(n)&&n.constructor===Array||(r=n.constructor)),!r&&e&&(r=e.constructor),this.options.enableCircularCheck&&this.recursionStack.add(n);var P=this.getKeys(r,n,c),S=e||{};!e&&(this.transformationType===M.PLAIN_TO_CLASS||this.transformationType===M.CLASS_TO_CLASS)&&(c?S=new Map:r?S=new r:S={});for(var C=function(L){if(L==="__proto__"||L==="constructor")return"continue";var H=L,F=L,j=L;if(!g.options.ignoreDecorators&&r){if(g.transformationType===M.PLAIN_TO_CLASS){var J=W.findExposeMetadataByCustomName(r,L);J&&(j=J.propertyName,F=J.propertyName)}else if(g.transformationType===M.CLASS_TO_PLAIN||g.transformationType===M.CLASS_TO_CLASS){var J=W.findExposeMetadata(r,L);J&&J.options&&J.options.name&&(F=J.options.name)}}var E=void 0;g.transformationType===M.PLAIN_TO_CLASS?E=n[H]:n instanceof Map?E=n.get(H):n[H]instanceof Function?E=n[H]():E=n[H];var R=void 0,K=E instanceof Map;if(r&&c)R=r;else if(r){var $=W.findTypeMetadata(r,j);if($){var At={newObject:S,object:n,property:j},lt=$.typeFunction?$.typeFunction(At):$.reflectedType;$.options&&$.options.discriminator&&$.options.discriminator.property&&$.options.discriminator.subTypes?n[H]instanceof Array?R=$:(g.transformationType===M.PLAIN_TO_CLASS&&(R=$.options.discriminator.subTypes.find(function(X){if(E&&E instanceof Object&&$.options.discriminator.property in E)return X.name===E[$.options.discriminator.property]}),R===void 0?R=lt:R=R.value,$.options.keepDiscriminatorProperty||E&&E instanceof Object&&$.options.discriminator.property in E&&delete E[$.options.discriminator.property]),g.transformationType===M.CLASS_TO_CLASS&&(R=E.constructor),g.transformationType===M.CLASS_TO_PLAIN&&E&&(E[$.options.discriminator.property]=$.options.discriminator.subTypes.find(function(X){return X.value===E.constructor}).name)):R=lt,K=K||$.reflectedType===Map}else if(g.options.targetMaps)g.options.targetMaps.filter(function(X){return X.target===r&&!!X.properties[j]}).forEach(function(X){return R=X.properties[j]});else if(g.options.enableImplicitConversion&&g.transformationType===M.PLAIN_TO_CLASS){var ht=Reflect.getMetadata("design:type",r.prototype,j);ht&&(R=ht)}}var gt=Array.isArray(n[H])?g.getReflectedType(r,j):void 0,mt=e?e[H]:void 0;if(S.constructor.prototype){var yt=Object.getOwnPropertyDescriptor(S.constructor.prototype,F);if((g.transformationType===M.PLAIN_TO_CLASS||g.transformationType===M.CLASS_TO_CLASS)&&(yt&&!yt.set||S[F]instanceof Function))return"continue"}if(!g.options.enableCircularCheck||!g.isCircular(E)){var rt=g.transformationType===M.PLAIN_TO_CLASS?F:L,T=void 0;g.transformationType===M.CLASS_TO_PLAIN?(T=n[rt],T=g.applyCustomTransformations(T,r,rt,n,g.transformationType),T=n[rt]===T?E:T,T=g.transform(mt,T,R,gt,K,d+1)):E===void 0&&g.options.exposeDefaultValues?T=S[F]:(T=g.transform(mt,E,R,gt,K,d+1),T=g.applyCustomTransformations(T,r,rt,n,g.transformationType)),(T!==void 0||g.options.exposeUnsetFields)&&(S instanceof Map?S.set(F,T):S[F]=T)}else if(g.transformationType===M.CLASS_TO_CLASS){var T=E;T=g.applyCustomTransformations(T,r,L,n,g.transformationType),(T!==void 0||g.options.exposeUnsetFields)&&(S instanceof Map?S.set(F,T):S[F]=T)}},g=this,Q=0,tt=P;Q<tt.length;Q++){var st=tt[Q];C(st)}return this.options.enableCircularCheck&&this.recursionStack.delete(n),S}else return n}},t.prototype.applyCustomTransformations=function(e,n,r,i,c){var d=this,y=W.findTransformMetadatas(n,r,this.transformationType);return this.options.version!==void 0&&(y=y.filter(function(w){return w.options?d.checkVersion(w.options.since,w.options.until):!0})),this.options.groups&&this.options.groups.length?y=y.filter(function(w){return w.options?d.checkGroups(w.options.groups):!0}):y=y.filter(function(w){return!w.options||!w.options.groups||!w.options.groups.length}),y.forEach(function(w){e=w.transformFn({value:e,key:r,obj:i,type:c,options:d.options})}),e},t.prototype.isCircular=function(e){return this.recursionStack.has(e)},t.prototype.getReflectedType=function(e,n){if(e){var r=W.findTypeMetadata(e,n);return r?r.reflectedType:void 0}},t.prototype.getKeys=function(e,n,r){var i=this,c=W.getStrategy(e);c==="none"&&(c=this.options.strategy||"exposeAll");var d=[];if((c==="exposeAll"||r)&&(n instanceof Map?d=Array.from(n.keys()):d=Object.keys(n)),r)return d;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&e){var y=W.getExposedProperties(e,this.transformationType),w=W.getExcludedProperties(e,this.transformationType);d=ie(ie([],y,!0),w,!0)}if(!this.options.ignoreDecorators&&e){var y=W.getExposedProperties(e,this.transformationType);this.transformationType===M.PLAIN_TO_CLASS&&(y=y.map(function(C){var g=W.findExposeMetadata(e,C);return g&&g.options&&g.options.name?g.options.name:C})),this.options.excludeExtraneousValues?d=y:d=d.concat(y);var P=W.getExcludedProperties(e,this.transformationType);P.length>0&&(d=d.filter(function(C){return!P.includes(C)})),this.options.version!==void 0&&(d=d.filter(function(C){var g=W.findExposeMetadata(e,C);return!g||!g.options?!0:i.checkVersion(g.options.since,g.options.until)})),this.options.groups&&this.options.groups.length?d=d.filter(function(C){var g=W.findExposeMetadata(e,C);return!g||!g.options?!0:i.checkGroups(g.options.groups)}):d=d.filter(function(C){var g=W.findExposeMetadata(e,C);return!g||!g.options||!g.options.groups||!g.options.groups.length})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(d=d.filter(function(S){return i.options.excludePrefixes.every(function(C){return S.substr(0,C.length)!==C})})),d=d.filter(function(S,C,g){return g.indexOf(S)===C}),d},t.prototype.checkVersion=function(e,n){var r=!0;return r&&e&&(r=this.options.version>=e),r&&n&&(r=this.options.version<n),r},t.prototype.checkGroups=function(e){return e?this.options.groups.some(function(n){return e.includes(n)}):!0},t}(),at={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},q=function(){return q=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},q.apply(this,arguments)},Ze=function(){function t(){}return t.prototype.instanceToPlain=function(e,n){var r=new it(M.CLASS_TO_PLAIN,q(q({},at),n));return r.transform(void 0,e,void 0,void 0,void 0,void 0)},t.prototype.classToPlainFromExist=function(e,n,r){var i=new it(M.CLASS_TO_PLAIN,q(q({},at),r));return i.transform(n,e,void 0,void 0,void 0,void 0)},t.prototype.plainToInstance=function(e,n,r){var i=new it(M.PLAIN_TO_CLASS,q(q({},at),r));return i.transform(void 0,n,e,void 0,void 0,void 0)},t.prototype.plainToClassFromExist=function(e,n,r){var i=new it(M.PLAIN_TO_CLASS,q(q({},at),r));return i.transform(e,n,void 0,void 0,void 0,void 0)},t.prototype.instanceToInstance=function(e,n){var r=new it(M.CLASS_TO_CLASS,q(q({},at),n));return r.transform(void 0,e,void 0,void 0,void 0,void 0)},t.prototype.classToClassFromExist=function(e,n,r){var i=new it(M.CLASS_TO_CLASS,q(q({},at),r));return i.transform(n,e,void 0,void 0,void 0,void 0)},t.prototype.serialize=function(e,n){return JSON.stringify(this.instanceToPlain(e,n))},t.prototype.deserialize=function(e,n,r){var i=JSON.parse(n);return this.plainToInstance(e,i,r)},t.prototype.deserializeArray=function(e,n,r){var i=JSON.parse(n);return this.plainToInstance(e,i,r)},t}(),le=new Ze;function Xe(t,e){return le.instanceToPlain(t,e)}function Ye(t,e,n){return le.plainToInstance(t,e,n)}let Lt=-1,Ot=-1;function It(t){Lt!==-1&&clearInterval(Lt),Ot!==-1&&clearInterval(Ot),Lt=setInterval(()=>{t.isAtHome&&(t.autoRecoverHpDot(),t.updateHealthDisplay())},1e3),Ot=setInterval(()=>{t.isAtHome&&pt(t)},1e4)}function pt(t){const e=Xe(t);localStorage.setItem("playerData",JSON.stringify(e))}function Ke(){const t=localStorage.getItem("playerData");if(!t)throw new Error("No player data found");const e=JSON.parse(t),n=Ye(wt,e,{enableImplicitConversion:!0});return It(n),n}function Nt(t,e,n,r){var w,P;const i=et();if(n&&r&&Fe(t,e,n,r),t.health<=0){t.addLog(t.name+"撑不住了"),ae(t,e,!1);return}if(e.health<1){t.addLog(t.name+"击败了"+e.name),ae(t,e,!0);return}r=e.getRandomAction();const c=Ue(t,e,r),d=t.getRandomAction(),y=t.getRandomAction();i.innerHTML=`
  <div class="container mt-4">
    <h2 class="text-center mb-3">战斗</h2>

    <!-- 敌人信息 -->
    <div class="card mb-3">
      <div class="card-header bg-danger text-white">
        <h4 class="mb-0">${e.name}</h4>
      </div>
      <div class="card-body">
        <p class="card-text fst-italic">"${e.description}"</p>
        <p class="card-text">${c}</p>
        <p class="card-text">HP: <strong>${Math.ceil(e.health)}</strong></p>
      </div>
    </div>

    <!-- 分割线 -->
    <hr>

    <!-- 玩家信息 -->
    <div class="card mb-4">
      <div class="card-header bg-success text-white">
        <h4 class="mb-0">${t.name}</h4>
      </div>
      <div class="card-body">
        <p class="card-text">HP: <strong>${Math.ceil(t.health)}</strong></p>
      </div>
    </div>

    <!-- 动作选择 -->
    <div class="row mb-4">
      <div class="col-6">
        <div class="card bg-primary text-white" id="action1-btn" style="cursor: pointer;">
          <div class="card-body text-center">
            <h5 class="card-title">${d.name}</h5>
            <p class="card-text">${d.description}</p>
            <p class="card-text">${d.hits.map(S=>`${S.category}(0~${Math.round(Dt(S.coeff,t.ability))})`).join("<br>")}
            </p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card bg-info text-white" id="action2-btn" style="cursor: pointer;">
          <div class="card-body text-center">
            <h5 class="card-title">${y.name}</h5>
            <p class="card-text">${y.description}</p>
            <p class="card-text">${y.hits.map(S=>`${S.category}(0~${Math.round(Dt(S.coeff,t.ability))})`).join("<br>")}
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- 战斗记录 -->
    <div class="card">
      <div class="card-header">
        记录
      </div>
      <div class="card-body" id="log" style="max-height: 200px; overflow-y: auto;">
        ${t.getTempLogs()}
      </div>
    </div>
  </div>
`,(w=document.getElementById("action1-btn"))==null||w.addEventListener("click",()=>{Nt(t,e,d,r)}),(P=document.getElementById("action2-btn"))==null||P.addEventListener("click",()=>{Nt(t,e,y,r)})}function ae(t,e,n){var i;const r=et();if(n){const c=e.randomDropItem();t.addLog(e.name+"掉落了<span style='color: gold;'>"+c.name+"</span>"),t.pack.push(c)}else t.health=1,t.addLog(t.name+"拼死从"+e.name+"的手中逃了出来，拖着残破的身躯，回到了城镇");r.innerHTML=`
  <div class="container mt-4">
    <div class="card text-center shadow">
      <div class="card-header bg-dark text-white">
        <h2 class="mb-0">战斗结束</h2>
      </div>
      <div class="card-body">
        <h4 class="card-title">
          ${t.name}
          ${n?'<span class="text-success">胜利</span>':'<span class="text-danger">失败</span>'}
        </h4>
        <hr>
        <h5>记录</h5>
        <div id="log" class="border rounded p-3" style="max-height: 250px; overflow-y: auto;">
          ${t.getTempLogs()}
        </div>
      </div>
      <div class="card-footer">
        <button class="btn btn-primary" id="main-menu-btn">返回主菜单</button>
      </div>
    </div>
  </div>
`,t.clearTempLogs(),pt(t),(i=document.getElementById("main-menu-btn"))==null||i.addEventListener("click",()=>{St(t)})}function Ve(t){let e=Object.values(Z)[Math.floor(Math.random()*Object.values(Z).length)];(e===Z.Player||e===Z.Player114514)&&(e=Z.Wolf);const n=Math.floor(Math.random()*10)+1,r=Math.random()*2,i=new je(ft[e].typeName,e,n,r);Nt(t,i,null,null)}function tn(){var e,n;const t=et();t.innerHTML=`
    <h1>你是谁？</h1>
    <div class="row mb-4">
      <div class="col-6">
        <div class="card bg-primary text-white" id="action1-btn" style="cursor: pointer;">
          <div class="card-body text-center">
            <h5 class="card-title">普通人</h5>
            <p class="card-text">你是一个正准备去上班/上学的普通人</p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card bg-info text-white" id="action2-btn" style="cursor: pointer;">
          <div class="card-body text-center">
            <h5 class="card-title">野兽仙贝</h5>
            <p class="card-text">你是野兽先辈，一番劳累过后，正准备返回自家天台晒日光浴</p>
          </div>
        </div>
      </div>
    </div>
  `,(e=document.getElementById("action1-btn"))==null||e.addEventListener("click",()=>{const r=new wt("吴田所",Z.Player);It(r),xt(r)}),(n=document.getElementById("action2-btn"))==null||n.addEventListener("click",()=>{const r=new wt("田所*二",Z.Player114514);It(r),xt(r)})}function xt(t){var i,c;const e=et(),n=Math.floor(Math.random()*4);let r="";switch(n){case 0:r="<p>车 →→→ 你</p>";break;case 1:r="<p>你 ←←← 车</p>";break;case 2:r=`
      <p style="text-align: center;">  车</p>
      <p style="text-align: center;">  ↓</p>
      <p style="text-align: center;">  你</p>`;break;case 3:r=`
      <p style="text-align: center;">  你</p>
      <p style="text-align: center;">  ↑</p>
      <p style="text-align: center;">  车</p>`;break}e.innerHTML=`
  <h1>躲避大卡车</h1>
  <p>一辆卡车正在向你快速驶来，请选择躲避方向</p>
  ${r}
  <button id="left-btn">向左躲避</button>
  <button id="right-btn">向右躲避</button>
`,(i=document.getElementById("left-btn"))==null||i.addEventListener("click",()=>{Math.random()>.3?xt(t):se(t)}),(c=document.getElementById("right-btn"))==null||c.addEventListener("click",()=>{Math.random()>.3?xt(t):se(t)})}function se(t){var n;const e=et();e.innerHTML=`
    <h1>躲避大卡车</h1>
    <p>躲避失败，你嗝屁了</p>
    <button id="continue-btn">继续</button>
  `,(n=document.getElementById("continue-btn"))==null||n.addEventListener("click",()=>{en(t)})}function en(t){var n;const e=et();e.innerHTML=`
    <h1>???</h1>
    <p>请输入你的名字</p>
    <input type="text" id="name-input" placeholder="${t.name}">
    <button id="continue-btn">继续</button>
  `,(n=document.getElementById("continue-btn"))==null||n.addEventListener("click",()=>{const i=document.getElementById("name-input").value.trim();i?(t.name=i,nn(t)):alert("请输入你的名字！")})}function nn(t){var n;const e=et();e.innerHTML=`
    <h1>???</h1>
    <p>你睁开了眼睛，发现自己好像身处森林之中</p>
    <p>周围的一切都显得那么陌生，充满了异世界风情</p>
    <p>看着远处地上缓慢蠕动的史莱姆，你总算相信自己穿越了</p>
    <button id="continue-btn">继续</button>
  `,(n=document.getElementById("continue-btn"))==null||n.addEventListener("click",()=>{pt(t),St(t)})}function St(t){var n,r,i;const e=et();t.isAtHome=!0,pt(t),console.log(t),e.innerHTML=`
  <div style="display: flex; justify-content: space-between; align-items: center;">
    <div>
      <h2>${t.name} lv ${t.level}</h2>
      <div>${t.type===Z.Player114514?"野兽":"人类"}</div>
      <div id="health-display" class="fs-4 mb-3">${t.getHealthDisplay()}</div>
    </div>
  </div>
  <div class="container mt-4">
    <h2 class="text-center mb-4">主菜单</h2>
    <div class="row g-3 justify-content-center">
      <div class="col-12 col-md-4">
        <button id="battle-btn" class="btn btn-primary w-100 py-3">${t.type===Z.Player114514?"救世啊！":"战斗"}</button>
      </div>
      <div class="col-12 col-md-4">
        <button id="status-btn" class="btn btn-success w-100 py-3">状态</button>
      </div>
      <div class="col-12 col-md-4">
        <button id="restart-btn" class="btn btn-danger w-100 py-3">秽土转生</button>
      </div>
    </div>
    <div class="text-center mt-4">
      <button class="btn btn-info" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">
        查看记录
      </button>
    </div>
  </div>

  <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasRightLabel">记录</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <div style="max-height: 60vh; overflow-y: auto;">
        <p>${t.getLastNLog(20)}</p>
      </div>
    </div>
  </div>
`,(n=document.getElementById("battle-btn"))==null||n.addEventListener("click",()=>{t.isAtHome=!1,Ve(t)}),(r=document.getElementById("status-btn"))==null||r.addEventListener("click",()=>{he(t)}),(i=document.getElementById("restart-btn"))==null||i.addEventListener("click",()=>{window.confirm("你确定要remake吗?")&&(localStorage.clear(),window.location.reload())})}function he(t){var n,r;const e=et();e.innerHTML=`
  <div class="container mt-4">
    <h2 class="text-center mb-4">状态</h2>

    <!-- 宠物区域 -->
    <div class="row mb-4">
      <div class="col">
        <h4>${t.name} 的宠物</h4>
        <div id="pet" class="border rounded p-3 bg-light">
          ${t.capturedMonster.length>0?t.capturedMonster.map(i=>`
                <div class="d-flex justify-content-between align-items-center mb-2">
                  <span class="fw-bold">${i.name}</span>
                  <span class="text-muted">Lv. ${i.level}</span>
                </div>
              `).join(""):'<p class="text-muted">暂无宠物</p>'}
        </div>
      </div>
    </div>

    <!-- 背包区域 -->
    <div class="row mb-4">
      <div class="col">
        <h4>${t.name} 的背包</h4>
        <div id="pack" class="d-flex flex-wrap gap-2">
          ${t.pack.length>0?t.pack.map(i=>{const c=i instanceof Tt?"btn-success":"btn-secondary";return`<button id="use-btn${i.uuid}" class="btn ${c}">${i.name}</button>`}).join(""):'<p class="text-muted">背包为空</p>'}
        </div>
      </div>
    </div>

    <!-- 返回主菜单按钮 -->
    <div class="text-center">
      <button id="back-btn" class="btn btn-primary">返回主菜单</button>
    </div>
  </div>
`,(n=document.getElementById("back-btn"))==null||n.addEventListener("click",()=>{St(t)});for(const i of t.pack)i instanceof Tt&&((r=document.getElementById(`use-btn${i.uuid}`))==null||r.addEventListener("click",()=>{i.useItem(t),t.addLog(t.name+"使用了"+i.name),pt(t),he(t)}))}document.addEventListener("DOMContentLoaded",()=>{let t;try{t=Ke()}catch(e){console.log(e),localStorage.clear(),tn();return}St(t)});
